<Window x:Class="IEMS.WPF.StudentsManagementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:IEMS.WPF.Controls"
        Title="Students Management" Height="700" Width="1600"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <!-- Main Content Grid -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Background="{StaticResource PrimaryBrush}" Orientation="Horizontal" Height="80">
            <TextBlock Text="ðŸ‘¥" FontSize="30" Margin="20,0" VerticalAlignment="Center"/>
            <TextBlock Text="Students Management System"
                       FontSize="20" FontWeight="Bold" Foreground="{StaticResource TextOnPrimaryBrush}"
                       VerticalAlignment="Center" Margin="10,0,0,0"/>
        </StackPanel>

        <!-- Main Content -->
        <TabControl Grid.Row="1" Margin="10">
            <TabItem Header="ðŸ“Š Dashboard" FontSize="14">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Overall Statistics Cards -->
                        <TextBlock Grid.Row="0" Text="ðŸ“Š School Overview" FontSize="18" FontWeight="Bold"
                                   Margin="0,0,0,15" Foreground="{StaticResource TextPrimaryBrush}"/>

                        <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,30">
                            <!-- Total Students Card -->
                            <Border Background="{StaticResource SuccessBrush}" CornerRadius="10" Margin="5">
                                <StackPanel Margin="20" HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ‘¥" FontSize="30" HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock x:Name="lblTotalStudents" Text="0" FontSize="24" FontWeight="Bold"
                                               HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock Text="Total Students" FontSize="12" HorizontalAlignment="Center" Foreground="White"/>
                                </StackPanel>
                            </Border>

                            <!-- Total Male Students Card -->
                            <Border Background="{StaticResource PrimaryBrush}" CornerRadius="10" Margin="5">
                                <StackPanel Margin="20" HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ‘¨â€ðŸŽ“" FontSize="30" HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock x:Name="lblMaleStudents" Text="0" FontSize="24" FontWeight="Bold"
                                               HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock Text="Male Students" FontSize="12" HorizontalAlignment="Center" Foreground="White"/>
                                </StackPanel>
                            </Border>

                            <!-- Total Female Students Card -->
                            <Border Background="{StaticResource DangerBrush}" CornerRadius="10" Margin="5">
                                <StackPanel Margin="20" HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ‘©â€ðŸŽ“" FontSize="30" HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock x:Name="lblFemaleStudents" Text="0" FontSize="24" FontWeight="Bold"
                                               HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock Text="Female Students" FontSize="12" HorizontalAlignment="Center" Foreground="White"/>
                                </StackPanel>
                            </Border>

                            <!-- Total Classes Card -->
                            <Border Background="{StaticResource SecondaryBrush}" CornerRadius="10" Margin="5">
                                <StackPanel Margin="20" HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ«" FontSize="30" HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock x:Name="lblTotalClasses" Text="0" FontSize="24" FontWeight="Bold"
                                               HorizontalAlignment="Center" Foreground="White"/>
                                    <TextBlock Text="Total Classes" FontSize="12" HorizontalAlignment="Center" Foreground="White"/>
                                </StackPanel>
                            </Border>
                        </UniformGrid>

                        <!-- Class-wise Statistics -->
                        <TextBlock Grid.Row="2" Text="ðŸ« Class-wise Breakdown" FontSize="18" FontWeight="Bold"
                                   Margin="0,0,0,15" Foreground="{StaticResource TextPrimaryBrush}"/>

                        <Grid Grid.Row="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Class-wise Total Count -->
                            <Border Grid.Column="0" Background="{StaticResource SurfaceBrush}" CornerRadius="10"
                                    Margin="5" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
                                <StackPanel Margin="15">
                                    <TextBlock Text="ðŸ“ˆ Students per Class" FontSize="14" FontWeight="Bold"
                                               Margin="0,0,0,10" Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <DataGrid x:Name="dgClassStats" AutoGenerateColumns="False" HeadersVisibility="Column"
                                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                                              GridLinesVisibility="Horizontal" BorderThickness="0" Background="Transparent"
                                              RowBackground="Transparent" AlternatingRowBackground="#F8F9FA">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Class" Binding="{Binding ClassName}" Width="80"/>
                                            <DataGridTextColumn Header="Total" Binding="{Binding TotalStudents}" Width="60"/>
                                            <DataGridTextColumn Header="Male" Binding="{Binding MaleStudents}" Width="60"/>
                                            <DataGridTextColumn Header="Female" Binding="{Binding FemaleStudents}" Width="60"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </Border>

                            <!-- Additional Statistics -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceBrush}" CornerRadius="10"
                                    Margin="5" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
                                <StackPanel Margin="15">
                                    <TextBlock Text="ðŸ“‹ Additional Statistics" FontSize="14" FontWeight="Bold"
                                               Margin="0,0,0,15" Foreground="{StaticResource TextPrimaryBrush}"/>

                                    <!-- BPL Students -->
                                    <StackPanel Orientation="Horizontal" Margin="0,5">
                                        <TextBlock Text="ðŸ  BPL Students:" Width="120" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <TextBlock x:Name="lblBPLStudents" Text="0" FontWeight="Bold" Foreground="{StaticResource SuccessBrush}"/>
                                    </StackPanel>

                                    <!-- Semi-English Students -->
                                    <StackPanel Orientation="Horizontal" Margin="0,5">
                                        <TextBlock Text="ðŸŒ Semi-English:" Width="120" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <TextBlock x:Name="lblSemiEnglishStudents" Text="0" FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}"/>
                                    </StackPanel>

                                    <!-- Religion wise breakdown -->
                                    <Separator Margin="0,15"/>
                                    <TextBlock Text="ðŸ•‰ï¸ Religion-wise Breakdown" FontSize="12" FontWeight="Bold"
                                               Margin="0,0,0,10" Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <DataGrid x:Name="dgReligionStats" AutoGenerateColumns="False" HeadersVisibility="Column"
                                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                                              GridLinesVisibility="Horizontal" BorderThickness="0" Background="Transparent"
                                              RowBackground="Transparent" AlternatingRowBackground="#F8F9FA">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Religion" Binding="{Binding Religion}" Width="100"/>
                                            <DataGridTextColumn Header="Count" Binding="{Binding Count}" Width="60"/>
                                            <DataGridTextColumn Header="Male" Binding="{Binding MaleCount}" Width="50"/>
                                            <DataGridTextColumn Header="Female" Binding="{Binding FemaleCount}" Width="50"/>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <!-- Caste Category breakdown -->
                                    <Separator Margin="0,15"/>
                                    <TextBlock Text="ðŸ“Š Caste Category Breakdown" FontSize="12" FontWeight="Bold"
                                               Margin="0,0,0,10" Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <DataGrid x:Name="dgCasteStats" AutoGenerateColumns="False" HeadersVisibility="Column"
                                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                                              GridLinesVisibility="Horizontal" BorderThickness="0" Background="Transparent"
                                              RowBackground="Transparent" AlternatingRowBackground="#F8F9FA">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="100"/>
                                            <DataGridTextColumn Header="Count" Binding="{Binding Count}" Width="60"/>
                                            <DataGridTextColumn Header="Male" Binding="{Binding MaleCount}" Width="50"/>
                                            <DataGridTextColumn Header="Female" Binding="{Binding FemaleCount}" Width="50"/>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <!-- City/Village breakdown -->
                                    <Separator Margin="0,15"/>
                                    <TextBlock Text="ðŸ˜ï¸ City/Village Breakdown" FontSize="12" FontWeight="Bold"
                                               Margin="0,0,0,10" Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <DataGrid x:Name="dgCityVillageStats" AutoGenerateColumns="False" HeadersVisibility="Column"
                                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                                              GridLinesVisibility="Horizontal" BorderThickness="0" Background="Transparent"
                                              RowBackground="Transparent" AlternatingRowBackground="#F8F9FA">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="City/Village" Binding="{Binding CityVillage}" Width="120"/>
                                            <DataGridTextColumn Header="Count" Binding="{Binding Count}" Width="60"/>
                                            <DataGridTextColumn Header="Male" Binding="{Binding MaleCount}" Width="50"/>
                                            <DataGridTextColumn Header="Female" Binding="{Binding FemaleCount}" Width="50"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="ðŸ“š Students" FontSize="14">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10,0,10">
                        <Button x:Name="btnAddStudent" Content="Add Student" Width="120" Height="35" Margin="0,0,10,0"
                                Click="BtnAddStudent_Click" Style="{StaticResource SuccessButtonStyle}"/>
                        <Button x:Name="btnEditStudent" Content="Edit Student" Width="120" Height="35" Margin="0,0,10,0"
                                Click="BtnEditStudent_Click" Style="{StaticResource PrimaryButtonStyle}"/>
                        <Button x:Name="btnDeleteStudent" Content="Delete Student" Width="130" Height="35" Margin="0,0,10,0"
                                Click="BtnDeleteStudent_Click" Style="{StaticResource DangerButtonStyle}"/>
                        <Button x:Name="btnRefreshStudents" Content="Refresh" Width="100" Height="35" Margin="0,0,10,0"
                                Click="BtnRefreshStudents_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                        <Separator Width="20"/>
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                        <TextBox x:Name="txtSearchStudents" Width="200" Height="25" VerticalAlignment="Center"
                                 TextChanged="TxtSearchStudents_TextChanged"
                                 ToolTip="Search by name, student number, father's name, or mobile number"/>
                    </StackPanel>

                    <DataGrid x:Name="dgStudents" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                              GridLinesVisibility="All" HeadersVisibility="Column" AlternatingRowBackground="{StaticResource SurfaceBrush}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Serial No" Binding="{Binding SerialNo}" Width="70"/>
                            <DataGridTextColumn Header="Standard" Binding="{Binding Standard}" Width="70"/>
                            <DataGridTextColumn Header="Division" Binding="{Binding ClassDivision}" Width="70"/>
                            <DataGridTextColumn Header="First Name" Binding="{Binding FirstName}" Width="100"/>
                            <DataGridTextColumn Header="Father's Name" Binding="{Binding FatherName}" Width="120"/>
                            <DataGridTextColumn Header="Surname" Binding="{Binding Surname}" Width="100"/>
                            <DataGridTextColumn Header="Date of Birth" Binding="{Binding FormattedDateOfBirth}" Width="90"/>
                            <DataGridTextColumn Header="Gender" Binding="{Binding Gender}" Width="70"/>
                            <DataGridTextColumn Header="Mother's Name" Binding="{Binding MotherName}" Width="120"/>
                            <DataGridTextColumn Header="Student No" Binding="{Binding StudentNumber}" Width="90"/>
                            <DataGridTextColumn Header="Admission Date" Binding="{Binding FormattedAdmissionDate}" Width="110"/>
                            <DataGridTextColumn Header="Caste Category" Binding="{Binding CasteCategory}" Width="110"/>
                            <DataGridTextColumn Header="Religion" Binding="{Binding Religion}" Width="80"/>
                            <DataGridTextColumn Header="BPL" Binding="{Binding IsBPL}" Width="50"/>
                            <DataGridTextColumn Header="Semi-English" Binding="{Binding IsSemiEnglish}" Width="100"/>
                            <DataGridTextColumn Header="Address" Binding="{Binding Address}" Width="150"/>
                            <DataGridTextColumn Header="Mobile" Binding="{Binding ParentMobileNumber}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="ðŸ« Classes" FontSize="14">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10,0,10">
                        <Button x:Name="btnAddClass" Content="Add Class" Width="120" Height="35" Margin="0,0,10,0"
                                Click="BtnAddClass_Click" Style="{StaticResource SuccessButtonStyle}"/>
                        <Button x:Name="btnEditClass" Content="Edit Class" Width="120" Height="35" Margin="0,0,10,0"
                                Click="BtnEditClass_Click" Style="{StaticResource PrimaryButtonStyle}"/>
                        <Button x:Name="btnDeleteClass" Content="Delete Class" Width="130" Height="35" Margin="0,0,10,0"
                                Click="BtnDeleteClass_Click" Style="{StaticResource DangerButtonStyle}"/>
                        <Button x:Name="btnRefreshClasses" Content="Refresh" Width="100" Height="35" Margin="0,0,10,0"
                                Click="BtnRefreshClasses_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                        <Button x:Name="btnViewClassStudents" Content="View Students" Width="120" Height="35" Margin="10,0,10,0"
                                Click="BtnViewClassStudents_Click" Style="{StaticResource PrimaryButtonStyle}"/>
                    </StackPanel>

                    <DataGrid x:Name="dgClasses" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                              GridLinesVisibility="All" HeadersVisibility="Column" AlternatingRowBackground="{StaticResource SurfaceBrush}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Class" Binding="{Binding DisplayName}" Width="150"/>
                            <DataGridTextColumn Header="Class Teacher" Binding="{Binding TeacherName}" Width="200"/>
                            <DataGridTextColumn Header="Students Enrolled" Binding="{Binding StudentCount}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="ðŸ’° Fee Payments" FontSize="14">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10,0,10">
                        <Button x:Name="btnAddFeePayment" Content="Record Payment" Width="120" Height="35" Margin="0,0,10,0"
                                Click="BtnAddFeePayment_Click" Style="{StaticResource SuccessButtonStyle}"/>
                        <Button x:Name="btnViewReceipt" Content="View Receipt" Width="120" Height="35" Margin="0,0,10,0"
                                Click="BtnViewReceipt_Click" Style="{StaticResource PrimaryButtonStyle}"/>
                        <Button x:Name="btnPrintReceipt" Content="Print Receipt" Width="120" Height="35" Margin="0,0,10,0"
                                Click="BtnPrintReceipt_Click" Background="#9B59B6" Foreground="White" BorderThickness="0"/>
                        <Button x:Name="btnRefreshFeePayments" Content="Refresh" Width="100" Height="35" Margin="0,0,10,0"
                                Click="BtnRefreshFeePayments_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                        <Separator Width="20"/>
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                        <TextBox x:Name="txtSearchFeePayments" Width="200" Height="25" VerticalAlignment="Center"
                                 TextChanged="TxtSearchFeePayments_TextChanged"
                                 ToolTip="Search by receipt number, student name, or fee type"/>
                    </StackPanel>

                    <DataGrid x:Name="dgFeePayments" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                              GridLinesVisibility="All" HeadersVisibility="Column" AlternatingRowBackground="{StaticResource SurfaceBrush}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Receipt No" Binding="{Binding ReceiptNumber}" Width="100"/>
                            <DataGridTextColumn Header="Student Name" Binding="{Binding StudentName}" Width="150"/>
                            <DataGridTextColumn Header="Class" Binding="{Binding ClassName}" Width="100"/>
                            <DataGridTextColumn Header="Fee Type" Binding="{Binding FeeTypeDisplay}" Width="100"/>
                            <DataGridTextColumn Header="Amount Paid" Binding="{Binding AmountPaidFormatted}" Width="100"/>
                            <DataGridTextColumn Header="Payment Method" Binding="{Binding PaymentMethodDisplay}" Width="120"/>
                            <DataGridTextColumn Header="Payment Date" Binding="{Binding PaymentDateFormatted}" Width="100"/>
                            <DataGridTextColumn Header="Remaining Balance" Binding="{Binding RemainingBalanceFormatted}" Width="120"/>
                            <DataGridTextColumn Header="Academic Year" Binding="{Binding AcademicYear}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="ðŸ“œ Bonafide" FontSize="14">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10,0,10">
                        <Button x:Name="btnGenerateBonafide" Content="Generate Certificate" Width="150" Height="35" Margin="0,0,10,0"
                                Click="BtnGenerateBonafide_Click" Style="{StaticResource SuccessButtonStyle}"/>
                        <Button x:Name="btnRefreshBonafide" Content="Refresh" Width="100" Height="35" Margin="0,0,10,0"
                                Click="BtnRefreshBonafide_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                        <Separator Width="20"/>
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                        <TextBox x:Name="txtSearchBonafide" Width="200" Height="25" VerticalAlignment="Center"
                                 TextChanged="TxtSearchBonafide_TextChanged"
                                 ToolTip="Search by student name, student number, or class"/>
                    </StackPanel>

                    <DataGrid x:Name="dgBonafideStudents" Grid.Row="1" AutoGenerateColumns="False"
                              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                              GridLinesVisibility="All" HeadersVisibility="Column" AlternatingRowBackground="{StaticResource SurfaceBrush}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Student No" Binding="{Binding StudentNumber}" Width="100"/>
                            <DataGridTextColumn Header="Full Name" Binding="{Binding FullName}" Width="200"/>
                            <DataGridTextColumn Header="Father's Name" Binding="{Binding FatherName}" Width="150"/>
                            <DataGridTextColumn Header="Mother's Name" Binding="{Binding MotherName}" Width="150"/>
                            <DataGridTextColumn Header="Class" Binding="{Binding ClassWithDivision}" Width="100"/>
                            <DataGridTextColumn Header="Date of Birth" Binding="{Binding FormattedDateOfBirth}" Width="100"/>
                            <DataGridTextColumn Header="Admission Date" Binding="{Binding FormattedAdmissionDate}" Width="110"/>
                            <DataGridTextColumn Header="Caste" Binding="{Binding CasteCategory}" Width="100"/>
                            <DataGridTextColumn Header="Religion" Binding="{Binding Religion}" Width="100"/>
                            <DataGridTextColumn Header="Gender" Binding="{Binding Gender}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Leaving Certificate Tab -->
            <TabItem Header="ðŸŽ“ Leaving Certificate" FontSize="14">
                <Grid Margin="20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Panel - Certificate Generation Form -->
                    <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Margin="0,0,20,0">
                        <Border Background="White" BorderBrush="{StaticResource SecondaryBrush}" BorderThickness="1"
                                CornerRadius="10" Padding="25">
                            <StackPanel>
                                <TextBlock Text="ðŸŽ“ Generate Leaving Certificate" FontSize="18" FontWeight="Bold"
                                           Margin="0,0,0,20" Foreground="{StaticResource TextPrimaryBrush}"/>

                                <!-- Student Selection -->
                                <TextBlock Text="Select Student:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbLeavingCertStudent" Margin="0,0,0,15" Height="35"
                                          DisplayMemberPath="FullNameWithAdmissionNumber"
                                          SelectionChanged="CmbLeavingCertStudent_SelectionChanged"/>

                                <!-- Student Details Grid -->
                                <Grid x:Name="gridLeavingCertDetails" Visibility="Collapsed" Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Student Information Display -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Student Name:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" x:Name="lblLeavingStudentName" Margin="10,5"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Mother's Name:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" x:Name="lblLeavingMotherName" Margin="10,5"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Father's Name:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" x:Name="lblLeavingFatherName" Margin="10,5"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Admission No:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" x:Name="lblLeavingAdmissionNo" Margin="10,5"/>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Student ID:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="4" Grid.Column="1" x:Name="lblLeavingStudentId" Margin="10,5"/>

                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Class:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="5" Grid.Column="1" x:Name="lblLeavingClass" Margin="10,5"/>

                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="Date of Birth:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="6" Grid.Column="1" x:Name="lblLeavingDOB" Margin="10,5"/>

                                    <TextBlock Grid.Row="7" Grid.Column="0" Text="Admission Date:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="7" Grid.Column="1" x:Name="lblLeavingAdmissionDate" Margin="10,5"/>

                                    <TextBlock Grid.Row="8" Grid.Column="0" Text="Religion:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="8" Grid.Column="1" x:Name="lblLeavingReligion" Margin="10,5"/>

                                    <TextBlock Grid.Row="9" Grid.Column="0" Text="Caste:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="9" Grid.Column="1" x:Name="lblLeavingCaste" Margin="10,5"/>


                                    <TextBlock Grid.Row="10" Grid.Column="0" Text="Mother Tongue:" FontWeight="Bold" Margin="0,5"/>
                                    <TextBlock Grid.Row="10" Grid.Column="1" x:Name="lblLeavingMotherTongue" Margin="10,5"/>

                                </Grid>

                                <!-- Leaving Certificate Specific Details -->
                                <TextBlock Text="Certificate Details:" FontWeight="Bold" FontSize="14" Margin="0,20,0,10"
                                           Foreground="{StaticResource TextPrimaryBrush}"/>

                                <TextBlock Text="Date of Leaving:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <DatePicker x:Name="dpLeavingDate" Margin="0,0,0,15" Height="35"/>

                                <TextBlock Text="Medium of Instruction:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbMedium" Margin="0,0,0,15" Height="35" SelectedIndex="0">
                                    <ComboBoxItem Content="English"/>
                                    <ComboBoxItem Content="Semi-English"/>
                                    <ComboBoxItem Content="Marathi"/>
                                </ComboBox>

                                <TextBlock Text="Mother Tongue:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbMotherTongue" Margin="0,0,0,5" Height="35" SelectionChanged="CmbMotherTongue_SelectionChanged">
                                    <ComboBoxItem Content="Marathi"/>
                                    <ComboBoxItem Content="Hindi"/>
                                    <ComboBoxItem Content="Other"/>
                                </ComboBox>
                                <TextBox x:Name="txtCustomMotherTongue" Margin="0,0,0,15" Height="35"
                                         Visibility="Collapsed" Tag="Enter mother tongue..."/>

                                <TextBlock Text="Place of Birth:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtPlaceOfBirth" Margin="0,0,0,15" Height="35" Tag="Enter place of birth..."/>

                                <TextBlock Text="Subcaste:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtSubcaste" Margin="0,0,0,15" Height="35" Tag="Enter subcaste..."/>

                                <TextBlock Text="Serial No.:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtSerialNoOverride" Margin="0,0,0,15" Height="35" Tag="Override serial number if needed..."/>

                                <TextBlock Text="Student ID:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtStudentId" Margin="0,0,0,15" Height="35" Tag="Enter student ID..."/>

                                <TextBlock Text="U.I.D. No. (Aadhaar Card No.):" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtAadhaarNumber" Margin="0,0,0,15" Height="35" Tag="Enter Aadhaar number..."/>

                                <TextBlock Text="Phone No. (Optional):" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtPhoneNumber" Margin="0,0,0,15" Height="35" Tag="Enter phone number..."/>

                                <TextBlock Text="Email (Optional):" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtEmail" Margin="0,0,0,15" Height="35" Tag="Enter email address..."/>

                                <TextBlock Text="General Register Number:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtGeneralRegisterNumber" Margin="0,0,0,15" Height="35" Tag="Enter general register number..."/>

                                <TextBlock Text="State:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtState" Margin="0,0,0,15" Height="35" Text="Maharashtra"/>

                                <TextBlock Text="Academic Session:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtAcademicSession" Margin="0,0,0,15" Height="35" Tag="e.g., 2025-26"/>

                                <TextBlock Text="Place of Birth (Village/City):" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtBirthPlace" Margin="0,0,0,15" Height="35" Tag="Enter birth place..."/>

                                <TextBlock Text="Taluka:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtTaluka" Margin="0,0,0,15" Height="35" Tag="Enter taluka..."/>

                                <TextBlock Text="District:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtDistrict" Margin="0,0,0,15" Height="35" Tag="Enter district..."/>

                                <TextBlock Text="State (Birth):" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtBirthState" Margin="0,0,0,15" Height="35" Text="Maharashtra"/>

                                <TextBlock Text="Reason for Leaving:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbLeavingReason" Margin="0,0,0,15" Height="35">
                                    <ComboBoxItem Content="Completed Course"/>
                                    <ComboBoxItem Content="Transfer to Another School"/>
                                    <ComboBoxItem Content="Family Relocation"/>
                                    <ComboBoxItem Content="Health Reasons"/>
                                    <ComboBoxItem Content="Financial Reasons"/>
                                    <ComboBoxItem Content="Personal Reasons"/>
                                    <ComboBoxItem Content="Other"/>
                                </ComboBox>

                                <TextBlock Text="Progress in Studies:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbProgressInStudies" Margin="0,0,0,15" Height="35" SelectedIndex="0">
                                    <ComboBoxItem Content="Excellent"/>
                                    <ComboBoxItem Content="Very Good"/>
                                    <ComboBoxItem Content="Good"/>
                                    <ComboBoxItem Content="Satisfactory"/>
                                </ComboBox>

                                <TextBlock Text="Behavior:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbCharacterConduct" Margin="0,0,0,15" Height="35" SelectedIndex="0">
                                    <ComboBoxItem Content="Excellent"/>
                                    <ComboBoxItem Content="Very Good"/>
                                    <ComboBoxItem Content="Good"/>
                                    <ComboBoxItem Content="Satisfactory"/>
                                </ComboBox>

                                <TextBlock Text="Last Class Studied:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtLastClass" Margin="0,0,0,15" Height="35"/>

                                <TextBlock Text="Previous School and Grade (Optional):" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtPreviousSchool" Margin="0,0,0,15" Height="35"/>

                                <TextBlock Text="Remarks (Optional):" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtLeavingRemarks" Margin="0,0,0,20" Height="60"
                                         TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>

                                <!-- Action Buttons -->
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
                                    <Button x:Name="btnGenerateLeavingCert" Content="ðŸŽ“ Generate Certificate"
                                            Background="{StaticResource SuccessBrush}" Foreground="White"
                                            Padding="15,10" Margin="0,0,10,0" FontWeight="Bold"
                                            Click="BtnGenerateLeavingCert_Click"/>
                                    <Button x:Name="btnPrintLeavingCert" Content="ðŸ–¨ï¸ Print Certificate"
                                            Background="{StaticResource InfoBrush}" Foreground="White"
                                            Padding="15,10" Margin="10,0,0,0" FontWeight="Bold"
                                            Click="BtnPrintLeavingCert_Click"/>
                                    <Button x:Name="btnExportLeavingCertPDF" Content="ðŸ“„ Export to PDF"
                                            Background="{StaticResource PrimaryBrush}" Foreground="White"
                                            Padding="15,10" Margin="10,0,0,0" FontWeight="Bold"
                                            Click="BtnExportLeavingCertPDF_Click"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>

                    <!-- Right Panel - Certificate Preview (A4 Size: 794x1122 pixels at 96 DPI) -->
                    <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <Border x:Name="LeavingCertificateBorder" Background="White" BorderBrush="#34495E"
                                BorderThickness="2" Padding="40" Width="794">
                            <StackPanel>
                                <!-- School Header Box -->
                                <Border BorderBrush="Black" BorderThickness="1" Padding="15" Margin="0,0,0,20">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Row 1 -->
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Name of Management:" FontSize="10" Margin="0,0,0,5"/>
                                        <Border Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock Text="Mahalakmi Bahuddeshiy Sanstha, Chikhalgaon" FontSize="10" Margin="5,0,0,0"/>
                                        </Border>

                                        <!-- Row 2 -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Name and full address of the school:" FontSize="10" Margin="0,5,0,5"/>
                                        <StackPanel Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3" Margin="0,5,0,0">
                                            <TextBlock Text="Inspire English Medium School, Mardi" FontSize="10" Margin="5,0,0,0"/>
                                            <TextBlock Text="Tah. Maregaon, Dist. Yavatmal (Maharashtra) â€“ 445303" FontSize="10" Margin="5,0,0,0"/>
                                        </StackPanel>

                                        <!-- Row 3 -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Phone No.:" FontSize="10" Margin="0,5,0,5"/>
                                        <Border Grid.Row="2" Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Margin="0,5,5,0">
                                            <TextBlock x:Name="CertHeaderPhone" FontSize="10" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Row="2" Grid.Column="2" Text="E-mail:" FontSize="10" Margin="5,5,0,5"/>
                                        <Border Grid.Row="2" Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Margin="0,5,0,0">
                                            <TextBlock x:Name="CertHeaderEmail" FontSize="10" Margin="5,0,0,0"/>
                                        </Border>

                                        <!-- Row 4 -->
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Serial No.:" FontSize="10" Margin="0,5,0,5"/>
                                        <Border Grid.Row="3" Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Margin="0,5,5,0">
                                            <TextBlock x:Name="CertHeaderSerialNo" FontSize="10" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Row="3" Grid.Column="2" Text="General Register No.:" FontSize="10" Margin="5,5,0,5"/>
                                        <Border Grid.Row="3" Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Margin="0,5,0,0">
                                            <TextBlock x:Name="CertHeaderGeneralRegister" FontSize="10" Margin="5,0,0,0"/>
                                        </Border>

                                        <!-- Row 5 -->
                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="School Accreditation No.:" FontSize="10" Margin="0,5,0,5"/>
                                        <Border Grid.Row="4" Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Margin="0,5,5,0">
                                            <TextBlock Text="115381/2016" FontSize="10" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Row="4" Grid.Column="2" Text="Medium:" FontSize="10" Margin="5,5,0,5"/>
                                        <Border Grid.Row="4" Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Margin="0,5,0,0">
                                            <TextBlock x:Name="CertMedium" FontSize="10" Margin="5,0,0,0"/>
                                        </Border>

                                        <!-- Row 6 -->
                                        <TextBlock Grid.Row="5" Grid.Column="0" Text="U-DISE Code:" FontSize="10" Margin="0,5,0,0"/>
                                        <TextBlock Grid.Row="5" Grid.Column="1" Text="27140806704" FontSize="10" FontWeight="Bold" Margin="0,5,5,0"/>
                                        <TextBlock Grid.Row="5" Grid.Column="2" Text="Board:" FontSize="10" Margin="5,5,0,0"/>
                                        <TextBlock Grid.Row="5" Grid.Column="3" Text="State" FontSize="10" FontWeight="Bold" Margin="0,5,0,0"/>
                                    </Grid>
                                </Border>

                                <!-- Certificate Title -->
                                <TextBlock Text="* School Leaving Certificate *" FontSize="16" FontWeight="Bold"
                                           HorizontalAlignment="Center" Margin="0,0,0,20"/>

                                <!-- Student ID Section -->
                                <StackPanel Margin="0,0,0,15">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Student ID:" FontSize="10" Margin="0,0,10,5"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <!-- Student ID Display -->
                                            <TextBlock x:Name="CertStudentId" FontSize="10" FontWeight="Bold"
                                                       VerticalAlignment="Center" MinWidth="100"/>
                                        </StackPanel>
                                    </Grid>

                                    <Grid Margin="0,5,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="U.I.D. No. (Aadhaar Card No.):" FontSize="10" Margin="0,0,10,0"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <!-- UID/Aadhaar Display -->
                                            <TextBlock x:Name="CertAadhaarNumber" FontSize="10" FontWeight="Bold"
                                                       VerticalAlignment="Center" MinWidth="150"/>
                                        </StackPanel>
                                    </Grid>

                                    <Grid Margin="0,5,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="P.E.N.:" FontSize="10" Margin="0,0,10,0"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <!-- PEN Boxes -->
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                            <Border BorderBrush="Black" BorderThickness="1" Width="15" Height="15" Margin="1,0"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>

                                <!-- Certificate Fields -->
                                <StackPanel Margin="0,0,0,20">
                                    <!-- Field 1 -->
                                    <Grid Margin="0,0,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="1) Full name of the student:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertStudentName" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 2 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="2) Mother's name:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertMotherName" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 3 & 4 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="3) Nationality:" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Indian" FontSize="11" FontWeight="Bold"/>
                                        <TextBlock Grid.Column="2" Text="4) Mother tongue:" FontSize="11"/>
                                        <Border Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertMotherTongue" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 5, 6, 7 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="5) Religion:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertReligion" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Column="2" Text="6) Caste:" FontSize="11" Margin="10,0,0,0"/>
                                        <Border Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertCaste" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Column="4" Text="7) Subcaste:" FontSize="11" Margin="10,0,0,0"/>
                                        <Border Grid.Column="5" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertSubcaste" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 8 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="8) Place of birth (village/city):" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertBirthPlace" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Column="2" Text="Taluka:" FontSize="11" Margin="10,0,0,0"/>
                                        <Border Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertTaluka" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Column="4" Text="District:" FontSize="11" Margin="10,0,0,0"/>
                                        <Border Grid.Column="5" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertDistrict" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="State:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertBirthStateDisplay" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Column="2" Text="Country:" FontSize="11" Margin="10,0,0,0"/>
                                        <TextBlock Grid.Column="3" Text="India" FontSize="11" FontWeight="Bold"/>
                                    </Grid>

                                    <!-- Field 9 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="9) Date of Birth (DD/MM/YYYY):" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertDateOfBirth" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 10 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="10) Date of Birth (in words):" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertDateOfBirthWords" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 11 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="11) Previous school and grade:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertPreviousSchool" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 12 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="12) Date of admission to this school:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertDateOfAdmission" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Column="2" Text="Class:" FontSize="11" Margin="10,0,0,0"/>
                                        <Border Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertAdmissionClass" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 13 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="13) Progress in studies:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertProgressInStudies" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                        <TextBlock Grid.Column="2" Text="Behavior:" FontSize="11" Margin="10,0,0,0"/>
                                        <Border Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertCharacterConduct" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 14 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="14) Date of leaving school:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertLeavingDate" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 15 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="300"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="15) In which grade were you studying and from when:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" MinHeight="25">
                                            <TextBlock x:Name="CertStandard" FontSize="11" Margin="5,0,0,0"
                                                       TextWrapping="Wrap" VerticalAlignment="Top"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 16 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="16) Reason for leaving school:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertLeavingReason" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>

                                    <!-- Field 17 -->
                                    <Grid Margin="0,5,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="17) Remark:" FontSize="11"/>
                                        <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15">
                                            <TextBlock x:Name="CertRemarks" FontSize="11" Margin="5,0,0,0"/>
                                        </Border>
                                    </Grid>
                                </StackPanel>

                                <!-- Certification Statement -->
                                <Grid Margin="0,20,0,30">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="380"/>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="It is certified that the above information is as per the General Register No." FontSize="11"/>
                                    <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Margin="5,0,5,0">
                                        <TextBlock x:Name="CertGeneralRegisterNumber" FontSize="11" Margin="5,0,0,0"/>
                                    </Border>
                                    <TextBlock Grid.Column="2" Text="of the school." FontSize="11"/>
                                </Grid>

                                <!-- Date -->
                                <Grid Margin="0,0,0,80">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="date:" FontSize="11"/>
                                    <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,0,1" Height="15" Width="200" HorizontalAlignment="Left">
                                        <TextBlock x:Name="CertIssueDate" FontSize="11" Margin="5,0,0,0"/>
                                    </Border>
                                </Grid>

                                <!-- Signature Section -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                        <Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="120" Height="15" Margin="0,0,0,5"/>
                                        <TextBlock Text="Class teacher" FontSize="11" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                        <TextBlock Text="Checked By" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="120" Height="15" Margin="0,0,0,5"/>
                                        <TextBlock Text="(Name and Signature)" FontSize="10" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                        <Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="120" Height="15" Margin="0,0,0,5"/>
                                        <TextBlock Text="Headmaster/Principal" FontSize="11" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Note -->
                                <TextBlock Text="Note: Any unauthorized changes to the school leaving certificate will result in legal action being taken against those concerned."
                                           FontSize="9" FontStyle="Italic" Margin="0,20,0,0" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <!-- Bulk Promotion Tab -->
            <TabItem Header="ðŸ“ˆ Bulk Promotion" FontSize="14">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <Border Grid.Row="0" Background="{StaticResource PrimaryBrush}" CornerRadius="10" Padding="15">
                        <StackPanel>
                            <TextBlock Text="ðŸ“ˆ Bulk Student Promotion" FontSize="20" FontWeight="Bold"
                                       Foreground="{StaticResource TextOnPrimaryBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="Promote multiple students from one class to another" FontSize="12"
                                       Foreground="{StaticResource PrimaryLightBrush}" HorizontalAlignment="Center" Margin="0,5"/>
                        </StackPanel>
                    </Border>

                    <!-- Promotion Configuration -->
                    <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" CornerRadius="10"
                            Padding="15" Margin="0,10" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                <TextBlock Text="From Class" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbPromotionFromClass" Height="35" DisplayMemberPath="Name" SelectedValuePath="Id" SelectionChanged="CmbPromotionFromClass_SelectionChanged"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Margin="10,0">
                                <TextBlock Text="To Class" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbPromotionToClass" Height="35" DisplayMemberPath="Name" SelectedValuePath="Id" SelectionChanged="CmbPromotionToClass_SelectionChanged"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2" Margin="10,0,0,0">
                                <TextBlock Text="Academic Year" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="cmbPromotionAcademicYear" Height="35" DisplayMemberPath="Year"
                                          SelectedValuePath="Year"/>
                            </StackPanel>

                            <StackPanel Grid.Column="3" VerticalAlignment="Bottom" Margin="15,0,0,0">
                                <Button x:Name="btnLoadPromotionPreview" Content="Load Preview" Height="35" Width="120"
                                        Style="{StaticResource PrimaryButtonStyle}" Click="BtnLoadPromotionPreview_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Main Content -->
                    <TabControl Grid.Row="2" Margin="0,10">
                        <!-- Preview Tab -->
                        <TabItem Header="Preview Students">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Summary Cards -->
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                                    <Border Background="{StaticResource SuccessLightBrush}" CornerRadius="8"
                                            Padding="15" MinWidth="150" Margin="0,0,10,0">
                                        <StackPanel>
                                            <TextBlock Text="Total Students" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                                            <TextBlock x:Name="txtPromotionTotalStudents" Text="0" FontSize="20" FontWeight="Bold"
                                                       Foreground="{StaticResource SuccessBrush}"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Background="{StaticResource PrimaryLightBrush}" CornerRadius="8"
                                            Padding="15" MinWidth="150" Margin="0,0,10,0">
                                        <StackPanel>
                                            <TextBlock Text="Eligible" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                                            <TextBlock x:Name="txtPromotionEligibleStudents" Text="0" FontSize="20" FontWeight="Bold"
                                                       Foreground="{StaticResource PrimaryBrush}"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Background="{StaticResource WarningLightBrush}" CornerRadius="8"
                                            Padding="15" MinWidth="150">
                                        <StackPanel>
                                            <TextBlock Text="Excluded" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                                            <TextBlock x:Name="txtPromotionExcludedStudents" Text="0" FontSize="20" FontWeight="Bold"
                                                       Foreground="{StaticResource WarningBrush}"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>

                                <!-- Students DataGrid -->
                                <DataGrid Grid.Row="1" x:Name="dgPromotionPreview" AutoGenerateColumns="False"
                                          CanUserAddRows="False" CanUserDeleteRows="False" GridLinesVisibility="Horizontal"
                                          HeadersVisibility="Column" SelectionMode="Extended">
                                    <DataGrid.Columns>
                                        <DataGridCheckBoxColumn Header="Exclude" Width="70">
                                            <DataGridCheckBoxColumn.Binding>
                                                <Binding Path="IsExcluded" UpdateSourceTrigger="PropertyChanged"/>
                                            </DataGridCheckBoxColumn.Binding>
                                        </DataGridCheckBoxColumn>
                                        <DataGridTextColumn Header="Student Name" Binding="{Binding StudentName}" Width="200" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Student No." Binding="{Binding StudentNumber}" Width="100" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Current Class" Binding="{Binding CurrentClass}" Width="120" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Target Class" Binding="{Binding TargetClass}" Width="120" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Pending Fees" Binding="{Binding PendingAmount, StringFormat=â‚¹{0:N2}}" Width="120" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Eligibility" Binding="{Binding IneligibilityReason}" Width="200" IsReadOnly="True"/>
                                        <DataGridCheckBoxColumn Header="Eligible" Binding="{Binding IsEligible}" Width="80" IsReadOnly="True"/>
                                    </DataGrid.Columns>
                                </DataGrid>

                                <!-- Filter Options -->
                                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                                    <CheckBox x:Name="chkPromotionShowOnlyEligible" Content="Show only eligible students" Margin="0,0,20,0"
                                              Checked="ChkPromotionShowOnlyEligible_Checked" Unchecked="ChkPromotionShowOnlyEligible_Unchecked"/>
                                    <CheckBox x:Name="chkPromotionShowPendingFees" Content="Show students with pending fees"
                                              Checked="ChkPromotionShowPendingFees_Checked" Unchecked="ChkPromotionShowPendingFees_Unchecked"/>
                                </StackPanel>
                            </Grid>
                        </TabItem>

                        <!-- Results Tab -->
                        <TabItem Header="Promotion Results" x:Name="tabPromotionResults">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Results Summary -->
                                <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}" CornerRadius="8"
                                        Padding="15" x:Name="borderPromotionResultsSummary" Visibility="Collapsed"
                                        BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
                                    <StackPanel>
                                        <TextBlock x:Name="txtPromotionResultsSummary" FontSize="14" FontWeight="SemiBold"/>
                                        <TextBlock x:Name="txtPromotionDate" FontSize="12" Foreground="Gray" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>

                                <!-- Errors DataGrid -->
                                <DataGrid Grid.Row="1" x:Name="dgPromotionErrors" AutoGenerateColumns="False"
                                          CanUserAddRows="False" CanUserDeleteRows="False" GridLinesVisibility="Horizontal"
                                          HeadersVisibility="Column" Margin="0,10,0,0">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Student Name" Binding="{Binding StudentName}" Width="200" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Error Description" Binding="{Binding Error}" Width="*" IsReadOnly="True"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                        <Button x:Name="btnExecutePromotion" Content="Execute Promotion" Width="150" Height="40"
                                Style="{StaticResource SuccessButtonStyle}" Click="BtnExecutePromotion_Click" IsEnabled="False"/>
                        <Button x:Name="btnCancelPromotion" Content="Reset" Width="100" Height="40" Margin="10,0,0,0"
                                Style="{StaticResource WarningButtonStyle}" Click="BtnCancelPromotion_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Height="25" Background="#34495E">
            <StatusBarItem>
                <TextBlock x:Name="lblStatus" Text="Ready" Foreground="White"/>
            </StatusBarItem>
        </StatusBar>

        <!-- Loading Overlay -->
        <controls:LoadingOverlay x:Name="loadingOverlay" IsLoading="False" LoadingMessage="Loading students..." Panel.ZIndex="999"/>

        <!-- Toast Notifications -->
        <controls:ToastNotification x:Name="toastNotification" Panel.ZIndex="1000"/>
    </Grid>
</Window>