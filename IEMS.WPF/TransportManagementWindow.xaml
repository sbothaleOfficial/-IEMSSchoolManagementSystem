<Window x:Class="IEMS.WPF.TransportManagementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Transport Management" Height="800" Width="1400"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <Grid Grid.Row="0" Background="#E67E22" Height="70">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                <Border Background="#D35400" Width="50" Height="50" CornerRadius="25" Margin="0,0,15,0">
                    <TextBlock Text="🚌" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <StackPanel VerticalAlignment="Center">
                    <TextBlock Text="Transport Management"
                               FontSize="22" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Manage Vehicles and Expenses"
                               FontSize="14" Foreground="LightGray" Margin="0,2,0,0"/>
                </StackPanel>
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,20,0">
                <Button x:Name="btnRefresh" Content="🔄 Refresh"
                        Background="#D35400" Foreground="White" BorderThickness="0"
                        Height="35" Width="80" Margin="5" Click="BtnRefresh_Click"
                        Style="{DynamicResource ModernButtonStyle}"/>
                <Button x:Name="btnClose" Content="✖ Close"
                        Background="#C0392B" Foreground="White" BorderThickness="0"
                        Height="35" Width="70" Margin="5" Click="BtnClose_Click"
                        Style="{DynamicResource ModernButtonStyle}"/>
            </StackPanel>
        </Grid>

        <!-- Main Content -->
        <TabControl Grid.Row="1" Margin="10">
            <!-- Vehicles Tab -->
            <TabItem Header="🚗 Vehicles">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Vehicle Controls -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button x:Name="btnAddVehicle" Content="➕ Add Vehicle"
                                Background="#27AE60" Foreground="White" BorderThickness="0"
                                Height="35" Width="120" Margin="0,0,10,0" Click="BtnAddVehicle_Click"
                                Style="{DynamicResource ModernButtonStyle}"/>
                        <Button x:Name="btnEditVehicle" Content="✏️ Edit Vehicle"
                                Background="#3498DB" Foreground="White" BorderThickness="0"
                                Height="35" Width="120" Margin="0,0,10,0" Click="BtnEditVehicle_Click"
                                Style="{DynamicResource ModernButtonStyle}"/>
                        <Button x:Name="btnDeleteVehicle" Content="🗑️ Delete Vehicle"
                                Background="#E74C3C" Foreground="White" BorderThickness="0"
                                Height="35" Width="130" Margin="0,0,10,0" Click="BtnDeleteVehicle_Click"
                                Style="{DynamicResource ModernButtonStyle}"/>
                        <Button x:Name="btnViewExpenses" Content="📊 View Expenses"
                                Background="#9B59B6" Foreground="White" BorderThickness="0"
                                Height="35" Width="130" Margin="0,0,10,0" Click="BtnViewExpenses_Click"
                                Style="{DynamicResource ModernButtonStyle}"/>
                    </StackPanel>

                    <!-- Vehicles DataGrid -->
                    <DataGrid x:Name="dgVehicles" Grid.Row="1"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              CanUserAddRows="False"
                              Background="White"
                              BorderBrush="#E0E0E0"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#F0F0F0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Vehicle Number" Binding="{Binding VehicleNumber}" Width="120"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding VehicleTypeName}" Width="100"/>
                            <DataGridTextColumn Header="Driver Name" Binding="{Binding DriverName}" Width="150"/>
                            <DataGridTextColumn Header="Driver Phone" Binding="{Binding DriverPhone}" Width="120"/>
                            <DataGridTextColumn Header="Route" Binding="{Binding Route}" Width="200"/>
                            <DataGridTextColumn Header="Total Expenses" Binding="{Binding TotalExpenses, StringFormat=₹{0:N2}}" Width="120"/>
                            <DataGridTextColumn Header="Expense Count" Binding="{Binding ExpenseCount}" Width="100"/>
                            <DataGridTextColumn Header="Created Date" Binding="{Binding CreatedAt, StringFormat=dd/MM/yyyy}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Expenses Tab -->
            <TabItem Header="💰 Expenses">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Expense Controls -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button x:Name="btnAddExpense" Content="➕ Add Expense"
                                Background="#27AE60" Foreground="White" BorderThickness="0"
                                Height="35" Width="120" Margin="0,0,10,0" Click="BtnAddExpense_Click"
                                Style="{DynamicResource ModernButtonStyle}"/>
                        <Button x:Name="btnEditExpense" Content="✏️ Edit Expense"
                                Background="#3498DB" Foreground="White" BorderThickness="0"
                                Height="35" Width="120" Margin="0,0,10,0" Click="BtnEditExpense_Click"
                                Style="{DynamicResource ModernButtonStyle}"/>
                        <Button x:Name="btnDeleteExpense" Content="🗑️ Delete Expense"
                                Background="#E74C3C" Foreground="White" BorderThickness="0"
                                Height="35" Width="130" Margin="0,0,10,0" Click="BtnDeleteExpense_Click"
                                Style="{DynamicResource ModernButtonStyle}"/>
                    </StackPanel>

                    <!-- Filter Panel -->
                    <Border Grid.Row="1" Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1"
                            Padding="15" Margin="0,0,0,10" CornerRadius="5">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Filter by Vehicle:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox x:Name="cmbFilterVehicle" Width="180" Height="30" Margin="0,0,20,0"
                                      DisplayMemberPath="DisplayText" SelectedValuePath="Id"
                                      SelectionChanged="CmbFilterVehicle_SelectionChanged"/>

                            <TextBlock Text="Category:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox x:Name="cmbFilterCategory" Width="120" Height="30" Margin="0,0,20,0"
                                      SelectionChanged="CmbFilterCategory_SelectionChanged"/>

                            <TextBlock Text="Date Range:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <DatePicker x:Name="dpFromDate" Width="120" Height="30" Margin="0,0,10,0"
                                        SelectedDateChanged="DateFilter_Changed"/>
                            <TextBlock Text="to" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <DatePicker x:Name="dpToDate" Width="120" Height="30" Margin="0,0,20,0"
                                        SelectedDateChanged="DateFilter_Changed"/>

                            <Button x:Name="btnClearFilter" Content="Clear Filter"
                                    Background="#95A5A6" Foreground="White" BorderThickness="0"
                                    Height="30" Width="80" Click="BtnClearFilter_Click"
                                    Style="{DynamicResource ModernButtonStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Expenses DataGrid -->
                    <DataGrid x:Name="dgExpenses" Grid.Row="2"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              CanUserAddRows="False"
                              Background="White"
                              BorderBrush="#E0E0E0"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#F0F0F0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Vehicle Number" Binding="{Binding VehicleNumber}" Width="120"/>
                            <DataGridTextColumn Header="Category" Binding="{Binding CategoryName}" Width="100"/>
                            <DataGridTextColumn Header="Fuel Type" Binding="{Binding FuelTypeName}" Width="80"/>
                            <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=₹{0:N2}}" Width="100"/>
                            <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity}" Width="80"/>
                            <DataGridTextColumn Header="Price/Unit" Binding="{Binding PricePerUnit, StringFormat=₹{0:N2}}" Width="100"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding ExpenseDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                            <DataGridTextColumn Header="Driver" Binding="{Binding DriverName}" Width="120"/>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="200"/>
                            <DataGridTextColumn Header="Invoice" Binding="{Binding InvoiceNumber}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Dashboard Tab -->
            <TabItem Header="📊 Dashboard">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Summary Cards -->
                        <UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,20">
                            <Border Background="#3498DB" CornerRadius="10" Margin="10" Padding="20">
                                <StackPanel>
                                    <TextBlock x:Name="lblTotalVehicles" Text="0" FontSize="28" FontWeight="Bold"
                                               Foreground="White" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Total Vehicles" FontSize="14" Foreground="White"
                                               HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#E74C3C" CornerRadius="10" Margin="10" Padding="20">
                                <StackPanel>
                                    <TextBlock x:Name="lblTotalExpenses" Text="₹0" FontSize="28" FontWeight="Bold"
                                               Foreground="White" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Total Expenses" FontSize="14" Foreground="White"
                                               HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#27AE60" CornerRadius="10" Margin="10" Padding="20">
                                <StackPanel>
                                    <TextBlock x:Name="lblMonthlyExpenses" Text="₹0" FontSize="28" FontWeight="Bold"
                                               Foreground="White" HorizontalAlignment="Center"/>
                                    <TextBlock Text="This Month" FontSize="14" Foreground="White"
                                               HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#9B59B6" CornerRadius="10" Margin="10" Padding="20">
                                <StackPanel>
                                    <TextBlock x:Name="lblAvgExpensePerVehicle" Text="₹0" FontSize="28" FontWeight="Bold"
                                               Foreground="White" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Avg per Vehicle" FontSize="14" Foreground="White"
                                               HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>
                        </UniformGrid>

                        <!-- Recent Activities -->
                        <Border Grid.Row="1" Background="White" CornerRadius="10"
                                BorderBrush="#E0E0E0" BorderThickness="1" Padding="20">
                            <StackPanel>
                                <TextBlock Text="Recent Transport Activities" FontSize="18" FontWeight="Bold"
                                           Foreground="#2C3E50" Margin="0,0,0,15"/>
                                <ListBox x:Name="lstRecentActivities" Background="Transparent" BorderThickness="0">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#F8F9FA" CornerRadius="5" Margin="0,2" Padding="10">
                                                <TextBlock Text="{Binding}" FontSize="12" Foreground="#34495E"/>
                                            </Border>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>
                        </Border>
                    </Grid>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Height="30" Background="#BDC3C7">
            <StatusBarItem>
                <TextBlock x:Name="lblStatus" Text="Transport Management Ready" Foreground="#2C3E50"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>

    <!-- Resources for Modern Button Style -->
    <Window.Resources>
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="5" BorderThickness="0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
    </Window.Resources>
</Window>